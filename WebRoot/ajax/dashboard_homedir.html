

<div class="row">
	<div class="col-xs-12 col-sm-7 col-md-7 col-lg-4">
		<h1 class="page-title txt-color-blueDark"><i class="fa-fw fa fa-home"></i>仪版表<span>>我的仪盘表</span></h1>
	</div>
</div>
<!-- widget grid -->
<section id="widget-grid" class="">

	<!-- row -->
	<div class="row">
		<article class="col-sm-12">
			<!-- new widget -->
			<div class="jarviswidget" id="wid-id-0" data-widget-togglebutton="false" data-widget-editbutton="false" data-widget-fullscreenbutton="false" data-widget-colorbutton="false" data-widget-deletebutton="false">
				<!-- widget options:
				usage: <div class="jarviswidget" id="wid-id-0" data-widget-editbutton="false">

				data-widget-colorbutton="false"
				data-widget-editbutton="false"
				data-widget-togglebutton="false"
				data-widget-deletebutton="false"
				data-widget-fullscreenbutton="false"
				data-widget-custombutton="false"
				data-widget-collapsed="true"
				data-widget-sortable="false"

				-->
				<header>
					<span class="widget-icon"> <i class="glyphicon glyphicon-stats txt-color-darken"></i> </span>
					<h2>home目录实时数据 </h2>

					<ul class="nav nav-tabs pull-right in" id="myTab">
						<li class="active">
							<a data-toggle="tab" href="#s1"><i class="fa fa-clock-o"></i> <span class="hidden-mobile hidden-tablet">实时状态</span></a>
						</li>
<!-- 
						<li>
							<a data-toggle="tab" href="#s4"><i class="fa fa-facebook"></i> <span class="hidden-mobile hidden-tablet">一周检测</span></a>
						</li>
 -->

						<li>
							<a data-toggle="tab" href="#s5"><i class="fa fa-dollar"></i> <span class="hidden-mobile hidden-tablet">一月检测</span></a>
						</li>
					</ul>

				</header>

				<!-- widget div-->
				<div class="no-padding">
					<!-- widget edit box -->
					<div class="jarviswidget-editbox">

						test
					</div>
					<!-- end widget edit box -->

					<div class="widget-body">
						<!-- content -->
						<div id="myTabContent" class="tab-content">
							<div class="tab-pane fade active in padding-10 no-padding-bottom" id="s1">
								<div class="row no-space">
									<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
										<span class="demo-liveupdate-1"> <span class="onoffswitch-title">24时查看</span> <span class="onoffswitch">
												<input type="checkbox" name="start_interval_homedir" class="onoffswitch-checkbox" id="start_interval_homedir">
												<label class="onoffswitch-label" for="start_interval_homedir"> 
													<span class="onoffswitch-inner" data-swchon-text="ON" data-swchoff-text="OFF"></span> 
													<span class="onoffswitch-switch"></span> </label> </span> </span>
										<div id="total"><p style="float:left;">总容量</p> <p style="float:left;" id="total_p"></p></div>
										<div id="updating-chart_homedir" class="chart-large txt-color-blue"></div>
									<div id="updating-chart-homedir-demo" style="height:100px;width:100%"  class="chart-large txt-color-blue"></div>
									</div>
							  	
						
								</div>

								

							</div>
							<!-- end s1 tab pane -->
	
							
							
							<div class="tab-pane fade  in padding-10 no-padding-bottom" id="s5">
								<div class="row no-space">
									<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
										<span class="demo-liveupdate-1"> <span class="onoffswitch-title">一月查看</span> <span class="onoffswitch">
												<input type="checkbox" name="start_interval_homedir_2" class="onoffswitch-checkbox" id="start_interval_homedir_2">
												<label class="onoffswitch-label" for="start_interval_homedir_2"> 
													<span class="onoffswitch-inner" data-swchon-text="ON" data-swchoff-text="OFF"></span> 
													<span class="onoffswitch-switch"></span> </label> </span> </span>
									<div id="total_m"><p style="float:left;">总容量</p> <p style="float:left;" id="total_p_m"></p></div>
										<div id="updating-chart_homedir_2" class="chart-large txt-color-blue"></div>
									<div id="updating-chart-homedir-2-demo" style="height:100px;width:100%"  class="chart-large txt-color-blue"></div>
									</div>
							  	
						
								</div>

								

							</div>
							
<!-- 
							
			 -->				
							<!-- end s3 tab pane -->
						</div>

						<!-- end content -->
					</div>

				</div>
				<!-- end widget div -->
			</div>
			<!-- end widget -->

		</article>
	</div>

	<!-- end row -->

	<!-- row -->

	

	<!-- end row -->

</section>
<!-- end widget grid -->

<script type="text/javascript">
	/* DO NOT REMOVE : GLOBAL FUNCTIONS!
	 *
	 * pageSetUp(); WILL CALL THE FOLLOWING FUNCTIONS
	 *
	 * // activate tooltips
	 * $("[rel=tooltip]").tooltip();
	 *
	 * // activate popovers
	 * $("[rel=popover]").popover();
	 *
	 * // activate popovers with hover states
	 * $("[rel=popover-hover]").popover({ trigger: "hover" });
	 *
	 * // activate inline charts
	 * runAllCharts();
	 *
	 * // setup widgets
	 * setup_widgets_desktop();
	 *
	 * // run form elements
	 * runAllForms();
	 *
	 ********************************
	 *
	 * pageSetUp() is needed whenever you load a page.
	 * It initializes and checks for all basic elements of the page
	 * and makes rendering easier.
	 *
	 */

	

	pageSetUp();

	/*
	 * PAGE RELATED SCRIPTS
	 */

	// pagefunction
	var flot_updating_chart_homedir, flot_updating_chart_homedir_1,flot_updating_chart_homedir_2;
	var pagefunction_homedir = function() {

	

		/*
		 * TODO: add a way to add more todo's to list
		 */

		// initialize sortable

	    

		/*
		 * RUN PAGE GRAPHS
		 */

		// load all flot plugins
		loadScript("js/plugin/flot/jquery.flot.cust.min.js", function(){
			loadScript("js/plugin/flot/jquery.flot.resize.min.js", function(){
				loadScript("js/plugin/flot/jquery.flot.time.min.js", function(){
					loadScript("js/plugin/flot/jquery.flot.tooltip.min.js", generatePageGraphs);
				});
			});
		});


		function generatePageGraphs() {

 		var $on = false;
 // setup control widget    //这是开始时的刷新时间，后面的是执行后刷新的时间
		var updateInterval = 1500;
		$("#updating-chart_homedir").val(updateInterval).change(function () {
		        var v = $(this).val();
		        if (v && !isNaN(+v)) {
		            updateInterval = +v;
		            $(this).val("" + updateInterval);
		        }
		    });

		    /* TAB 1: UPDATING CHART */ 
		    // For the demo we use generated data, but normally it would be coming from the server
				var rea = [];
		    	 var res=[];
				 var data1=[];
				var data = [],
		        totalPoints = 1440,
		        $UpdatingChartColors = $("#updating-chart_homedir").css('color');
          //获得后台数据
		    function getRandomData_homedir() {
		     res=[];
		            var re;
		        if($on=true){
		        $.ajax({
		            	url:"homedir/Day.do",
		            	dataType:"json",
		            	method:"get",
		            	success:function(result,textStatus,jqXHR){
		            	rea = [];
		    	 		res=[];
				 		data1=[];
						data = [],
		            	$.each(result,function(k,v){
		            	if(k=="homedir"){
		            	re=v;
  						$.each(re,function(name,value) {
  						try{
  						if(name=="application_amount"){
						$.each(value,function(k1,v1){
						var y = v1.value;
			            data.push(y);
			            var va=v1.timestamp;
			            var x=parseInt(va*1000);
			            rea.push(x);
						});
						}
  						}catch(err){
  						alert("homedir后台无数据");
  						}
						
						if(name=="total"){
						$.each(value,function(k2,v2){
						var to=v2.value;
						$("#total_p").html(to);
						});
						}
						});
		            	}
		            	   });
		            	},
		            	error:function(jqXHR, textStatus, errorThrown){
		            	}
		            	});
		       			 }
		            
		              for (var i = 0; i < data.length; i++){
		            	res.push([rea[i], data[i]])
		            	}
		            	
		            return res;
		    }

		   

			var d=new Date();
		     d.setMinutes(d.getMinutes()-1);
		     var d1=new Date();
		     d1.setDate(d.getDate()-1);
		    // setup plot
		    var options_homedir = {
		        yaxis: {
		       		ticks: [[0, "0"], [10, "10"], [20, "20"], [30, "30"], [40, "40"], [50, "50"],[60,"60"],[70,"70"],[80,"80"],[90,"90"],[100,"100"]],
		            min: 0,
		            max: 100
		        },
		        xaxis: {
		        	mode: "time" ,
    				timeformat: "%m/%d/%h" ,
    				tickSize: [2, "hour"],
    				min:d1,
    				max:d
		        },
		        
		        colors: [$UpdatingChartColors],
		        
		        series: {
		            lines: {
		                lineWidth: 1,
		                fill: true,
		                fillColor: {
		                    colors: [{
		                        opacity: 0.4
		                    }, {
		                        opacity: 0
		                    }]
		                },
		                steps: false

		            }
		        }
		    };

		    flot_updating_chart_homedir = $.plot($("#updating-chart_homedir"), [getRandomData_homedir()], options_homedir);
 /*********************************************************************/
		var overview= $.plot("#updating-chart-homedir-demo",  [getRandomData_homedir()], {
            series: {
                lines: {
                    show: true,
                    lineWidth: 1,
                     fill: true,
		                fillColor: {
		                    colors: [{
		                        opacity: 0.4
		                    }, {
		                        opacity: 0
		                    }]
		                },
                },
                shadowSize: 0
            },
            xaxis: {
		        	mode: "time" ,
    				timeformat: "%m/%d/%h" ,
    				tickSize: [2, "hour"],
    				min:d1,
    				max:d
		        },
            yaxis: {
             ticks: [[0, "0"],  [50, "50"],[100,"100"]],
                min: 0,
                autoscaleMargin: 0.1//自动缩放间隔空余 压缩空余间隔
            },
            selection: {
                mode: "x"
            }
        });
        
        $("#updating-chart_homedir").bind("plotselected", function (event, ranges) {
            // do the zooming
            $.each(flot_updating_chart_homedir.getXAxes(), function(_, axis) {
                var opts = axis.options;
                opts.min = ranges.xaxis.from;
                opts.max = ranges.xaxis.to;
            });
            flot_updating_chart_homedir.setupGrid();
            flot_updating_chart_homedir.draw();
            flot_updating_chart_homedir.clearSelection();
            // don't fire event on the overview to prevent eternal loop
            overview.setSelection(ranges, true);
        });
        $("#updating-chart-homedir-demo").bind("plotselected", function (event, ranges) {
            flot_updating_chart_homedir.setSelection(ranges);
        });   
        
 /**************************************************************************/  
function update() {

				try {
			        if ($on == true) {
			            flot_updating_chart_homedir.setData([getRandomData_homedir()]);
			            flot_updating_chart_homedir.draw();
			            overview.setData([getRandomData_homedir()]);
			            overview.draw();
			            setTimeout(update, updateInterval);

			        } else {
			            clearInterval(updateInterval)
			        }
				}
				catch(err) {
				    clearInterval(updateInterval);
				}

		    }

		    /* live switch */
		    $('input[type="checkbox"]#start_interval_homedir').click(function () {
		        if ($(this).prop('checked')) {
		            $on = true;
		            updateInterval = 60000;
		            update();
		        } else {
		            clearInterval(updateInterval);
		            $on = false;
		        }
		    });
		     

/*start start_interval_2      进行一月检测时 */

 				var rea_m = [];
		    	var res_m=[];
				 var data1=[];
				var data_m = [];
		     function getRandomData_homedir_2() {
		            var re;
		            if($on=true){
		            $.ajax({
		            	url:"homedir/Month.do",
		            	dataType:"json",
		            	method:"get",
		            	success:function(result,textStatus,jqXHR){
		            	rea_m = [];
		    			res_m=[];
				 		data1=[];
						data_m = [];
		            	$.each(result,function(k,v){
		            	if(k=="homedir_month"){
		            	$.each(v,function(k1,v1){
		            	try{
		            	if(k1=="application_amount"){
		            	   		$.each(v1,function(k2,v2){
		            	   		var y=v2.value;
		            	   		data_m.push(y);
		            	   		 var va=v2.timestamp;
		           				 var x=parseInt(va*1000);
		            			rea_m.push(x);
		            	   		});
		            	   		}
		            	}catch(err){
		            	alert("homedir_month后台无数据");
		            	}
		            			if(k1=="total"){
									$.each(v1,function(k2,v2){
									var to=v2.value;
									$("#total_p_m").html(to);
									});
									}
		            	   		});
		            	   		
		            	}
		            	   });
		            	},
		            	error:function(jqXHR, textStatus, errorThrown){
		            	}
		            });
		            }
		            
		              for (var i = 0;i<data_m.length;i++){
		            	res_m.push([rea_m[i], data_m[i]])
		            	}
		            return res_m;
		    }
		    
		       var d=new Date();
		     d.setMinutes(d.getMinutes()-1);
		     var d1=new Date();
		     d1.setMonth(d.getMonth()-1);
		     // setup plot
		    var options_homedir_2 = {
		        yaxis: {
		       		ticks: [[0, "0"], [10, "10"], [20, "20"], [30, "30"], [40, "40"], [50, "50"],[60,"60"],[70,"70"],[80,"80"],[90,"90"],[100,"100"]],
		            min: 0,
		            max: 100
		        },
		        xaxis: {
		        	mode: "time" ,
    				timeformat: "%m/%d/%h" ,
    				tickSize: [3, "day"],
    				min:d1,
    				max:d
		        },
		        
		        colors: [$UpdatingChartColors],
		        
		        series: {
		            lines: {
		                lineWidth: 1,
		                fill: true,
		                fillColor: {
		                    colors: [{
		                        opacity: 0.4
		                    }, {
		                        opacity: 0
		                    }]
		                },
		                steps: false

		            }
		        }
		    };
		    
		      flot_updating_chart_homedir_2 = $.plot($("#updating-chart_homedir_2"), [getRandomData_homedir_2()], options_homedir_2);
/*********************************************************************/
		var overview2= $.plot("#updating-chart-homedir-2-demo",  [getRandomData_homedir_2()], {
            series: {
                lines: {
                    show: true,
                    lineWidth: 1,
                     fill: true,
		                fillColor: {
		                    colors: [{
		                        opacity: 0.4
		                    }, {
		                        opacity: 0
		                    }]
		                },
                },
                shadowSize: 0
            },
            xaxis: {
		        	mode: "time" ,
    				timeformat: "%m/%d/%h" ,
    				tickSize: [3, "day"],
    				min:d1,
    				max:d
		        },
            yaxis: {
             ticks: [[0, "0"],  [50, "50"],[100,"100"]],
                min: 0,
                autoscaleMargin: 0.1//自动缩放间隔空余 压缩空余间隔
            },
            selection: {
                mode: "x"
            }
        });
        
        $("#updating-chart_homedir_2").bind("plotselected", function (event, ranges) {
            // do the zooming
            $.each(flot_updating_chart_homedir_2.getXAxes(), function(_, axis) {
                var opts = axis.options;
                opts.min = ranges.xaxis.from;
                opts.max = ranges.xaxis.to;
            });
            flot_updating_chart_homedir_2.setupGrid();
            flot_updating_chart_homedir_2.draw();
            flot_updating_chart_homedir_2.clearSelection();
            // don't fire event on the overview to prevent eternal loop
            overview2.setSelection(ranges, true);
        });
        $("#updating-chart-homedir-2-demo").bind("plotselected", function (event, ranges) {
            flot_updating_chart_homedir_2.setSelection(ranges);
        });   
        
 /**************************************************************************/  
 function update_2() {
				try {
			        if ($on == true) {
			            flot_updating_chart_homedir_2.setData([getRandomData_homedir_2()]);
			            flot_updating_chart_homedir_2.draw();
			            overview2.setData([getRandomData_homedir_2()]);
			            overview2.draw();
			            setTimeout(update, updateInterval);
			        } else {
			            clearInterval(updateInterval)
			        }
				}
				catch(err) {
				    clearInterval(updateInterval);
				}
		    }
		    
  $('input[type="checkbox"]#start_interval_homedir_2').click(function () {
		        if ($(this).prop('checked')) {
		            $on = true;
		            updateInterval = 60000;
		            update_2();
		        } else {
		            clearInterval(updateInterval);
		            $on = false;
		        }
		    });
		    
		       
		   
/*end atart_interval_2*/
/**		    function update() {

				try {
			        if ($on == true) {
			            flot_updating_chart.setData([getRandomData()]);
			            flot_updating_chart.draw();
			            setTimeout(update, updateInterval);

			        } else {
			            clearInterval(updateInterval)
			        }
				}
				catch(err) {
				    clearInterval(updateInterval);
				}

		    }
**/
		   

		    /*end updating chart*/

		    /* TAB 2: Social Network  */

		   };

	};

	// end pagefunction

	// destroy generated instances 
	// pagedestroy is called automatically before loading a new page
	// only usable in AJAX version!
/**
	var pagedestroy = function(){

		// destroy calendar
		calendar.fullCalendar('destroy');
		calendar = null;

		//destroy flots
		flot_updating_chart.shutdown();
		flot_updating_chart=null;
		flot_statsChart.shutdown();
		flot_statsChart = null;

		flot_multigraph.shutdown();
		flot_multigraph = null;

		// destroy vector map objects
		$('#vector-map').find('*').addBack().off().remove();

		// destroy todo
		$("#sortable1, #sortable2").sortable("destroy");
		$('.todo .checkbox > input[type="checkbox"]').off();

		// destroy misc events
		$("#rev-toggles").find(':checkbox').off();
		$('#chat-container').find('*').addBack().off().remove();

		// debug msg
		if (debugState){
			root.console.log("鉁� Calendar, Flot Charts, Vector map, misc events destroyed");
		}

	}
**/
	// end destroy
var pagedestroy = function(){

		// destroy calendar
	
		//destroy flots
		flot_updating_chart_homedir.shutdown();
	flot_updating_chart_homedir=null;
		flot_updating_chart_homedir_1.shutdown();
		flot_updating_chart_homedir_1=null;
		flot_updating_chart_homedir_2.shutdown();
		flot_updating_chart_homedir_2=null;
}
	// run pagefunction on load
	pagefunction_homedir();

	

</script>

