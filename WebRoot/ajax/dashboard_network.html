<div class="row">
	<div class="col-xs-12 col-sm-7 col-md-7 col-lg-4">
		<h1 class="page-title txt-color-blueDark"><i class="fa-fw fa fa-home"></i>仪版表<span>>我的仪盘表</span></h1>
	</div>
</div>
<!-- widget grid -->
<section id="widget-grid" class="">

	<!-- row -->
	<div class="row">
		<article class="col-sm-12">
			<!-- new widget -->
			<div class="jarviswidget" id="wid-id-0" data-widget-togglebutton="false" data-widget-editbutton="false" data-widget-fullscreenbutton="false" data-widget-colorbutton="false" data-widget-deletebutton="false">
				<!-- widget options:
				usage: <div class="jarviswidget" id="wid-id-0" data-widget-editbutton="false">

				data-widget-colorbutton="false"
				data-widget-editbutton="false"
				data-widget-togglebutton="false"
				data-widget-deletebutton="false"
				data-widget-fullscreenbutton="false"
				data-widget-custombutton="false"
				data-widget-collapsed="true"
				data-widget-sortable="false"

				-->
				<header>
					<span class="widget-icon"> <i class="glyphicon glyphicon-stats txt-color-darken"></i> </span>
					<h2>Network实时数据 </h2>

					<ul class="nav nav-tabs pull-right in" id="myTab">
						<li class="active">
							<a data-toggle="tab" href="#s1"><i class="fa fa-clock-o"></i> <span class="hidden-mobile hidden-tablet">实时状态</span></a>
						</li>
<!-- 
						<li>
							<a data-toggle="tab" href="#s4"><i class="fa fa-facebook"></i> <span class="hidden-mobile hidden-tablet">一周检测</span></a>
						</li>
 -->
						<li>
							<a data-toggle="tab" href="#s5"><i class="fa fa-dollar"></i> <span class="hidden-mobile hidden-tablet">一月检测</span></a>
						</li>
					</ul>

				</header>

				<!-- widget div-->
				<div class="no-padding">
					<!-- widget edit box -->
					<div class="jarviswidget-editbox">
						test
					</div>
					<!-- end widget edit box -->

					<div class="widget-body">
						<!-- content -->
						<div id="myTabContent" class="tab-content"><!-- 基于标签式的导航实例 -->
							<div class="tab-pane fade in active padding-10 no-padding-bottom" id="s1"><!-- fade in 这个属性是设置淡入淡出效果 -->
								<div class="row no-space">
								<!-- 修改zdl col-xs-12 col-sm-12 col-md-8 col-lg-8-->
									<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
										<span class="demo-liveupdate-1"> <span class="onoffswitch-title">24时查看</span> <span class="onoffswitch">
												<input type="checkbox" name="start_interval" class="onoffswitch-checkbox" id="start_interval">
												<label class="onoffswitch-label" for="start_interval"> 
													<span class="onoffswitch-inner" data-swchon-text="ON" data-swchoff-text="OFF"></span> 
													<span class="onoffswitch-switch"></span> </label> </span> </span>
										<div id="updating-chart_network_1" class="chart-large txt-color-blue"></div>
										<div id="updating-chart-network_1_demo" style="height:100px;width:100%"  class="chart-large txt-color-blue"></div>
<br> 
<table>
<tr style="width:100%">
<td style="width:20%;padding-left:50px;">
<div id="timeSelectedTr">
<label>选择日期 &nbsp;</label>

  <form class="form-horizontal">
                 <fieldset>
                  <div class="control-group">
                    <div class="controls">
                     <div class="input-prepend input-group">
                       <span class="add-on input-group-addon"><i class="glyphicon glyphicon-calendar fa fa-calendar"></i></span><input type="text" readonly style="width: 200px" name="birthday" id="birthday" class="form-control" value="03/18/2013" /> 
                     </div>
                    </div>
                  </div>
                 </fieldset>
   </form>
               
<input type="text" data-date-format="yyyy-mm-d" data-date-autoclose="true" id="dateSelect">
</div>
</td>
<td style="width:20%">
<div id="drapdown" class="drapdown">
<label>网卡选择&nbsp;</label>
<button id="dropdownButton" class="btn btn-default dropdown-toggle" type="button"  data-toggle="dropdown" aria-expanded="false">
bond0
<span class="caret"></span>
</button>
<ul class="dropdown-menu"> <li><a id="bond0" href="#" onclick="update()"></a></li> <li><a id="bond1" onclick="updateBond1()" href="#"></a></li> <li><a id="bond2" href="#"></a></li> 

</ul>

</div>
</td>
</tr>
</table>

									</div>
							
								</div>

							</div>
							<!-- end s1 tab pane -->
	<!--  zdl 2106629					
<div class="tab-pane fade  in padding-10 no-padding-bottom" id="s4">
								<div class="row no-space">
									<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
										<span class="demo-liveupdate-1"> <span class="onoffswitch-title">一周查看</span> <span class="onoffswitch">
												<input type="checkbox" name="start_interval_1" class="onoffswitch-checkbox" id="start_interval_1">
												<label class="onoffswitch-label" for="start_interval_1"> 
													<span class="onoffswitch-inner" data-swchon-text="ON" data-swchoff-text="OFF"></span> 
													<span class="onoffswitch-switch"></span> </label> </span> </span>
										<div id="updating-chart_network_2" class="chart-large txt-color-blue"></div>
										<div id="updating-chart-network-1-demo" style="height:100px;width:100%"  class="chart-large txt-color-blue"></div>
																<div id="updating-chart-network-demo" style="height:100px;width:100%"  class="chart-large txt-color-blue"></div>
<br> 
<table>
<tr style="width:100%">
<td style="width:20%;padding-left:50px;">
<div id="timeSelectedTr">
<label>选择日期 &nbsp;</label>
<input type="text" data-date-format="yyyy-mm-d" data-date-autoclose="true" id="dateSelect">
</div>
</td>
<td style="width:20%">
<div id="drapdown" class="drapdown">
<label>网卡选择&nbsp;</label>
<button id="dropdownButton" class="btn btn-default dropdown-toggle" type="button"  data-toggle="dropdown" aria-expanded="false">
bond0
<span class="caret"></span>
</button>
<ul class="dropdown-menu"> <li><a id="bond0" href="#" onclick="update()"></a></li> <li><a id="bond1" onclick="updateBond1()" href="#"></a></li> <li><a id="bond2" href="#"></a></li> 

</ul>

</div>
</td>
</tr>
</table>
									</div>
								</div>
							</div>
	<!-- end s4 tab pane -->

							
							
							<div class="tab-pane fade  in padding-10 no-padding-bottom" id="s5">
								<div class="row no-space">
									<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
										<span class="demo-liveupdate-1"> <span class="onoffswitch-title">一月查看</span> <span class="onoffswitch">
												<input type="checkbox" name="start_interval_2" class="onoffswitch-checkbox" id="start_interval_2">
												<label class="onoffswitch-label" for="start_interval_2"> 
													<span class="onoffswitch-inner" data-swchon-text="ON" data-swchoff-text="OFF"></span> 
													<span class="onoffswitch-switch"></span> </label> </span> </span>
										<div id="updating-chart_network_3" class="chart-large txt-color-blue"></div>
										<div id="updating-chart-network_3_demo" style="height:100px;width:100%"  class="chart-large txt-color-blue"></div>
<br> 
<table>
<tr style="width:100%">
<td style="width:20%;padding-left:50px;">
<div id="timeSelectedTr">
<label>选择日期 &nbsp;</label>
<input type="text" data-date-format="yyyy-mm-d" data-date-autoclose="true" id="dateSelect">
</div>
</td>
<td style="width:20%">
<div id="drapdown" class="drapdown">
<label>网卡选择&nbsp;</label>
<button id="dropdownButton" class="btn btn-default dropdown-toggle" type="button"  data-toggle="dropdown" aria-expanded="false">
bond0
<span class="caret"></span>
</button>
<ul class="dropdown-menu"> <li><a id="bond0" href="#" onclick="update()"></a></li> <li><a id="bond1" onclick="updateBond1()" href="#"></a></li> <li><a id="bond2" href="#"></a></li> 

</ul>

</div>
</td>
</tr>
</table>
									</div>
								</div>
							</div>
								<!-- end s5 tab pane -->
				
						</div>

						<!-- end content -->
					</div>

				</div>
				<!-- end widget div -->
			</div>
			<!-- end widget -->

		</article>
	</div>

	<!-- end row -->

	<!-- row -->

	

	<!-- end row -->

</section>
<!-- end widget grid -->

<script type="text/javascript">
	/* DO NOT REMOVE : GLOBAL FUNCTIONS!
	 *
	 * pageSetUp(); WILL CALL THE FOLLOWING FUNCTIONS
	 *
	 * // activate tooltips
	 * $("[rel=tooltip]").tooltip();
	 *
	 * // activate popovers
	 * $("[rel=popover]").popover();
	 *
	 * // activate popovers with hover states
	 * $("[rel=popover-hover]").popover({ trigger: "hover" });
	 *
	 * // activate inline charts
	 * runAllCharts();
	 *
	 * // setup widgets
	 * setup_widgets_desktop();
	 *
	 * // run form elements
	 * runAllForms();
	 *
	 ********************************
	 *
	 * pageSetUp() is needed whenever you load a page.
	 * It initializes and checks for all basic elements of the page
	 * and makes rendering easier.
	 *
	 */

	

	pageSetUp();
	/***************这是时间的插件使用*******************/
	/*
	 * PAGE RELATED SCRIPTS
	 */

	// pagefunction  
	var flot_updating_chart_network,flot_updating_chart_network_1,flot_updating_chart_network_2;
	var pagefunction_network = function() {
	
	var $UpdatingChartColors = $("#updating-chart").css('color');;
	var updateInterval=1500;
		// load all flot plugins  
		//动态加载js
	loadScript("js/plugin/flot/zdl/jquery.flot.min.js", function(){
		loadScript("js/plugin/flot/jquery.flot.cust.min.js", function(){
			loadScript("js/plugin/flot/jquery.flot.resize.min.js", function(){
				loadScript("js/plugin/flot/jquery.flot.time.min.js", function(){
					loadScript("js/plugin/flot/jquery.flot.tooltip.min.js", generatePageGraphs_network);
					});
				});
			});
		});


		function generatePageGraphs_network() {
				
 				
				var dataset = [];
				var res = [];
				var res1 = [];
				var resB01 = [];
				var resB0 = [];
				var datasetB0 = [];
				var reslutBond = new Object();//用来接收获得数据暂存这里
	          	var reaB01 = [];
		    	var reaB0 = [];
				var dataB0 = [];
				var dataB01 = [];
				
				var rea1 = [];
		    	var rea = [];
				var data = [];
				var data1 = [];
		     function getRandomData() {
		          
		            $.ajax({					//往后台获取数据
		            	url:"network/Day.do",
		            	dataType:"json",
		            	method:"get",
		            	success:function(result,textStatus,jqXHR) {
		            	if(result!=null){
		            	reslutBond=result;
		            	$.each(result,function(k,v){
		            	$.each(v,function(k1,v1){
		            	if(k1=="bond0"){
		            	$("#bond0").html("bond0");
		            	};
		            	if(k1=="bond1"){
		            	$("#bond1").html("bond1");
		            	};
		            	if(k1=="bond2"){
		            	$("#bond2").html("bond2");
		            	}
		            	});
		            	});
		            	}else{
		            	alert("result is null");
		            	}
		            	},
		            	error:function(jqXHR, textStatus, errorThrown) {
		            	alert("get network fail");
		            	}
		            });
		          
		    }
		     //将后台数据进行遍历bond0和bond1和bond2     
		    function getBond0Data(){  //驼峰式命名方式
		       getRandomData();
		       data=[];
		       rea=[];
		       data1=[];
		       rea1=[];
		       res=[];
		       res1=[];
		       $.each(reslutBond,function(k1,v1) {
		            	$.each(v1,function(k2,v2) {
		            	if(k2 == "bond0"){
		            	$.each(v2,function(k3,v3) {
		            	if(k3 == "network_input") {
		            	$.each(v3,function(k4,v4) {
		            	var y = v4.value;
		            	data.push(y);
		            	var va = v4.timestamp;
		            	var x = parseInt(va*1000);
		            	rea.push(x);
		            	});
		            	};
		            	var json = eval(v3.network_output)  
		            	if(k3 == "network_output"){
		            	$.each(v3,function(k5,v5){
		            	var y = v5.value;
		            	data1.push(y);
		            	var va = v5.timestamp;
		            	var x = parseInt(va*1000);
		            	rea1.push(x);
		            	});
		            	}
		            	});
		            	};
		            	});
		            	});
		       //进行对X和Y的遍历到新的数组里
		          for (var i = 0; i < data.length;i++){
		            	res.push([rea[i], data[i]]);
		            	}
		          for (var j = 0; j < data1.length;j++){
		            	res1.push([rea1[j], data1[j]]);
		            	}
		        
		       //将一个bond0的network_input和network_output放进数组对象
		          dataset=[{   //bond0的数据
		          label:"network_input",
		          data:res
		          },{
		          label:"network_output",
		          data:res1
		          }]; 
		          return dataset;
		    }
		    
		    //将bond1的数据遍历出来
		   function getBond1Data(){
		   getRandomData();
		    $.each(reslutBond,function(k1,v1) {
		    if(k2 == "bond1") {  //获得bond1的数据，将其进行遍历出来
		            	$.each(v2,function(k3,v3){
		            	if(k3 == "network_input"){
		            	$.each(v3,function(k4,v4){
		            	var y = v4.value;
		            	dataB0.push(y);
		            	var va = v4.timestamp;
		            	var x = parseInt(va*1000);
		            	reaB0.push(x);
		            	});
		            	};
		            	var json = eval(v3.network_output)  
		            	if(k3 == "network_output"){
		            	$.each(v3,function(k5,v5){
		            	var y = v5.value;
		            	dataB01.push(y);
		            	var va = v5.timestamp;
		            	var x = parseInt(va*1000);
		            	reaB01.push(x);
		            	});
		            	}
		            	});
		            	}
		    
		    });
		     for (var i = 0; i < dataB0.length;i++){
		            	resB0.push([reaB0[i], dataB0[i]]);
		            	}
		     for (var j = 0; j < dataB01.length;j++){
		            	resB01.push([reaB01[j], dataB01[j]]);
		            	}	
		            	
		             datasetB0=[{		//bond1的数据
		          label:"network_input",
		          data:resB0
		          },{
		          label:"network_output",
		          data:resB01
		          }];  	
		   return datasetB0;
		   }
		   
		     // setup plot
		   var options ={
				 	series: { lines: {
				            	show:true,
				                lineWidth: 0.7
		
				            }
				        },
				    xaxis: {
				        ticks: []
				    },
				    yaxes: [{
				       
				    }
				],
				selection: {
				                mode: "x"
				            }
				};
	 
/***************有bug 无法使用伸缩轴******************************************************/
		var option_demo={
     			series: {
		            lines: {
		            	show:true,
		                lineWidth: 0.7

		            }
		        },
		         xaxis: {
        			ticks: []
    			},
           		 yaxes: [{}
           		 ],
            	selection: {
                	mode: "x"
            	}
        	};
        	debugger;
    flot_updating_chart_network=$.plot($("#updating-chart_network_1"),[ getBond0Data()], options);
   var overview=$.plot($("#updating-chart-network_1_demo"),[ getBond0Data()], option_demo);
        $("#updating-chart_network_1").bind("plotselected", function (event, ranges) {
            // do the zooming
           
           
            $.each(flot_updating_chart_network.getXAxes(), function(_, axis) {
                var opts = axis.options;
                opts.min = ranges.xaxis.from;
                opts.max = ranges.xaxis.to;
            });
            flot_updating_chart_network.setupGrid();
            flot_updating_chart_network.draw();
            flot_updating_chart_network.clearSelection();
            // don't fire event on the overview to prevent eternal loop
            overview.setSelection(ranges, true);
        });
        $("#updating-chart-network_1_demo").bind("plotselected", function (event, ranges) {
              debugger;
            flot_updating_chart_network.setSelection(ranges);
        });   
 /**************************************************************************/  
		    function update() {
				try {
			        if ($on == true) {
			     // flot_updating_chart_network.setData(getRandomData());
			   	//flot_updating_chart_network.draw();
			   		//	getRandomData();
			   		 
			   	 		$.plot($("#updating-chart_network_1"), getBond0Data(), options);
//			            $("#updating-chart_network_1").draw();
			         $.plot("#updating-chart-network_1_demo",  getBond0Data(), option_demo);
//			          $("##updating-chart-network-demo").draw();
			            setTimeout(update, updateInterval);
			        } else {
			            clearInterval(updateInterval)
			        }
				}
				catch(err) {
				    clearInterval(updateInterval);
				}
		    }
		    //这里是用来获得bond1的数据
		 function   updateBond1() {
				try {
			        if ($on == true) {
			   
			   	 		$.plot($("#updating-chart_network_1"), getBond1Data(), options);
//			            $("#updating-chart_network_1").draw();
			         $.plot("#updating-chart-network-demo",  getBond1Data(), option_demo);
//			          $("##updating-chart-network-demo").draw();
			            setTimeout(update, updateInterval);
			        } else {
			            clearInterval(updateInterval)
			        }
				}
				catch(err) {
				    clearInterval(updateInterval);
				}
		    }
  $('input[type="checkbox"]#start_interval').click(function () {
		        if ($(this).prop('checked')) {
		            $on = true;
		            updateInterval = 60000;
		            update();
		        } else {
		            clearInterval(updateInterval);
		            $on = false;
		        }
		    });

/*start start_interval_2      进行一月检测时 */
			
 				var rea_m = [];
		    	var res_m=[];
		    	var rea_m1 = [];
		    	var res_m1=[];
				var data_m1=[];
				var data_m = [];
				var dataset2=[];
				var dataResult=[];
		     function getRandomData_2() {
		            var re;
		            $.ajax({
		            	url:"network/Month.do",
		            	dataType:"json",
		            	method:"get",
		            	success:function(result,textStatus,jqXHR){
		            	dataResult=result;
		            	},
		            	error:function(jqXHR, textStatus, errorThrown){
		            	alert("network失败");
		            	}
		            });
		       
		         
		    }
		    function getMDataBond0(){
		    debugger;
		    getRandomData_2();
		  	$.each(reslutBond,function(k1,v1) {
		            	$.each(v1,function(k2,v2) {
		            	if(k2 == "bond0"){
		            	$.each(v2,function(k3,v3) {
		            	if(k3 == "network_input") {
		            	$.each(v3,function(k4,v4) {
		            	var y = v4.value;
		            	data_m.push(y);
		            	var va = v4.timestamp;
		            	var x = parseInt(va*1000);
		            	rea_m.push(x);
		            	});
		            	};
		            	var json = eval(v3.network_output)  
		            	if(k3 == "network_output"){
		            	$.each(v3,function(k5,v5){
		            	var y = v5.value;
		            	data_m1.push(y);
		            	var va = v5.timestamp;
		            	var x = parseInt(va*1000);
		            	rea_m1.push(x);
		            	});
		            	}
		            	});
		            	};
		            	});
		            	});
		           for (var i = 0; i < data_m.length;i++){
		            	res_m.push([rea_m[i], data_m[i]]);
		            	}
		          for (var j = 0; j < data_m1.length;j++){
		            	res_m1.push([rea_m1[j], data_m1[j]]);
		            	}
		          dataset2=[{
		          label:"network_input",
		          data:res_m
		          },{
		          label:"network_output",
		          data:res_m1
		          
		          }];  	
		          console.log("res_m=="+res_m);
		          console.log("res_m1=="+res_m1);
		            	return dataset2; 
		    
		    }
		    var d=new Date();
		    d.setMinutes(d.getMinutes()-1);
		    var d1=new Date();
		    d1.setDate(d.getDate()-1);
		     // setup plot
		   var options_2={
				 	series: { 
				 		lines: {
				            	show:true,
				                lineWidth: 0.7
		
				            }
				        },
				    xaxis: {
				        ticks: []
				    },
				    yaxes: [{
				       
				    }
				],
				selection: {
				                mode: "x"
				            }
				};
				
		    debugger;
		    flot_updating_chart_network_2 = $.plot($("#updating-chart_network_3"), getMDataBond0(), options_2);
		     var overview_m=$.plot($("#updating-chart-network_3_demo"),dataset2, option_demo);
        $("#updating-chart_network_3").bind("plotselected", function (event, ranges) {
            // do the zooming
            $.each(flot_updating_chart_network_2.getXAxes(), function(_, axis) {
                var opts = axis.options;
                opts.min = ranges.xaxis.from;
                opts.max = ranges.xaxis.to;
            });
            flot_updating_chart_network_2.setupGrid();
            flot_updating_chart_network_2.draw();
            flot_updating_chart_network_2.clearSelection();
            // don't fire event on the overview to prevent eternal loop
            overview_m.setSelection(ranges, true);
        });
        $("#updating-chart-network_3_demo").bind("plotselected", function (event, ranges) {
              debugger;
            flot_updating_chart_network_2.setSelection(ranges);
        }); 
		    function update_2() {
				try {
			        if ($on == true) {
			   			debugger;
			   			var data111=new Date();
			   		  	console.log("data="+data111);
			   	 		$.plot($("#updating-chart_network_3"), getMDataBond0(), options_2);
			   	 		console.log("dataset2=="+dataset2);
			   	 		$.plot($("#updating-chart-network_3_demo"),dataset2, option_demo);
			            setTimeout(update_2, updateInterval);
			        } else {
			            clearInterval(updateInterval)
			        }
				}
				catch(err) {
				    clearInterval(updateInterval);
				}
		    }
		   
  $('input[type="checkbox"]#start_interval_2').click(function () {
		        if ($(this).prop('checked')) {
		            $on = true;
		            updateInterval = 60000;
		            debugger;
		            update_2();
		        } else {
		            clearInterval(updateInterval);
		            $on = false;
		        }
		    });
		    
		    
				
		    
		     

	};
};///这是我自己添加的
	
	
var pagedestroy = function(){

		// destroy calendar
	
		//destroy flots
		flot_updating_chart_network.shutdown();
		flot_updating_chart_network=null;
		flot_updating_chart_network_1.shutdown();
		flot_updating_chart_network_1=null;
		flot_updating_chart_network_2.shutdown();
		flot_updating_chart_network_2=null;
}	
	

		pagefunction_network();

	


</script>

